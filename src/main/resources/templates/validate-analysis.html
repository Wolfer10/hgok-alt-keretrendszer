<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css}" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<!--    <link rel="stylesheet" th:href="@{/css/default.min.css}">-->
<!--    <link rel="stylesheet" th:href="@{/css/intellij-light.min.css}">-->
    <link rel="stylesheet" th:href="@{/static/css/vs.min.css}">
    <script th:src="@{/js/highlight.min.js}"></script>
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <link th:href="@{/css/validation.css}" rel="stylesheet">
</head>
<body>
<div th:insert="header :: navbar"></div>

<div>
    <h1>Elemzés <span th:text="${analyis.getId()}"></span></h1>
    <h2 th:if="${currentLink != null}" th:text="${currentLink.getLabel() }"></h2>
    <div class="container">
        <pre th:if="${currentLink != null}" th:utext="${currentLink.getSourceSnippet()}"></pre>
        <pre th:if="${currentLink != null}" th:utext="${currentLink.getTargetSnippet()}"></pre>
<!--        <p th:text="${currentLink.getAccepted()}"></p>-->
        <div class="column-wrapper">
            <form id="validation-form" class="column-wrapper">
                <label>
                    Még talonban
                    <input type="radio" name="valid-link" value="unchecked"
                           th:checked="${currentLink.getState() == unchecked}">
                </label>
                <label>
                    Helyes él
                    <input type="radio" name="valid-link" value="accepted"
                           th:checked="${ currentLink.getState() ==  accepted}">
                </label>
                <label>
                    Helytelen él
                    <input type="radio" name="valid-link" value="denied"
                           th:checked="${currentLink.getState() == denied}">
                </label>
            </form>
            <div class="stepping column-wrapper">
                <form th:if="${linkIterator.hasNext()}"
                      th:action="@{/validate/{analysisId}/nextlink/{id}(id=${currentLink.getId()},analysisId=${analyis.getId()})}">
                    <input type="submit" value="Következő">
                </form>
                <form th:if="${linkIterator.hasPrevious()}"
                      th:action="@{/validate/{analysisId}/prevlink/{id}(id=${currentLink.getId()},analysisId=${analyis.getId()})}">
                    <input type="submit" value="Előző">
                </form>
                <form th:if="${!linkIterator.hasNext()}" th:action="@{/validate/end}" method="post">
                    <input type="submit" value="Kész">
                </form>
            </div>
        </div>
    </div>



    <script th:inline="javascript">
        function exucute_validation(){
            $.post(/*[[ @{/validateLink} ]]*/, {valid_link : $("input[name='valid-link']:checked").val()});
        }
        window.onload = () => {
            var form = document.getElementById("validation-form");
            form.addEventListener("submit", function (event) {
                event.preventDefault(); // prevent form submission and reloading the page.
            });
            $("input[name='valid-link']").change(exucute_validation);
            console.log("HELLLOO");
            //console.log(document.querySelectorAll('pre'));
            document.querySelectorAll('pre').forEach((el) => {
                hljs.highlightElement(el);
            });
        };
    </script>
</div>




</body>
</html>